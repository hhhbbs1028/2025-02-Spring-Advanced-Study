# 9.3 애플리케이션 아키텍처

## 9.3.1 계층형 아키텍처  
- 책임과 성격이 다른 코드를 계층 단위로 분리하는 아키텍처
- 관심사 분리를 통해 개발, 변경, 테스트를 용이하게 함
- 일반적인 웹 엔터프라이즈 애플리케이션은 3계층 구조 사용

### 3계층 구성
- 프레젠테이션 계층
  - 웹 요청/응답 처리, 화면 로직 담당
  - MVC 패턴의 Controller가 대표적
- 서비스 계층
  - 비즈니스 로직의 핵심
  - 이상적으로 POJO로 구현
- 데이터 액세스 계층 (DAO / EIS)
  - DB 및 외부 시스템 접근 담당
  - 저장, 조회 로직 수행

### 설계 원칙
- 각 계층은 높은 응집도와 낮은 결합도를 유지해야 함
- 계층 간에는 특정 기술에 종속된 타입을 직접 노출하지 말아야 함
- 계층 경계를 넘을 때는 도메인 오브젝트 또는 DTO 사용
- 체크 예외 대신 런타임 예외를 사용해 계층 간 종속 최소화
- 스프링 DI는 계층을 강제하지 않으므로 빈 의존 관계 설계에 주의

## 9.3.2 애플리케이션 정보 아키텍처 
- 계층 사이에서 애플리케이션 정보를 어떤 형태로 전달할지를 정의하는 구조
- 정보 전달 방식에 따라 아키텍처의 유연성과 결합도가 달라짐

### 주요 방식
- DB/SQL 중심 아키텍처
  - SQL 결과에 애플리케이션 코드가 종속됨
  - SQL 변경 시 전 계층 수정 필요
  - 테스트 및 유지보수 어려움
- 거대한 서비스 계층 (Fat Service Layer)
  - 비즈니스 로직을 서비스 계층에 집중
  - DAO는 단순한 데이터 접근 역할
  - 테스트는 쉬우나 서비스와 DAO 간 결합이 여전히 존재
- 도메인/DTO 중심 정보 전달
  - 의미 있는 오브젝트를 계층 간 전달
  - 구조의 일관성과 재사용성 향상 

## 9.3.3 오브젝트 중심 아키텍처  
- 도메인 모델을 반영한 오브젝트 구조를 기반으로 하는 아키텍처
- 계층 간 데이터 전달을 SQL 결과가 아닌 도메인 오브젝트로 수행

### 특징
- 도메인 모델과 애플리케이션 구조가 일관됨
- 타입만 보고도 전달되는 정보의 의미를 파악 가능
- 재사용 가능한 비즈니스 메서드 설계 용이

### 장단점
- 장점
  - 계층 간 결합도 감소
  - 테스트 용이성 향상
- 단점
  - 불필요한 데이터 로딩으로 성능 저하 가능
  - 도메인 오브젝트가 커질수록 관리 부담 증가
- 해결 방안
  - Lazy Loading 적용
  - ORM(JPA, Hibernate 등) 사용 권장

### 도메인 오브젝트 스타일
- 빈약한 도메인 오브젝트 (Anemic Domain Model)
  - 데이터만 보유하고 로직은 서비스 계층에 집중
  - 서비스 계층 비대화 우려
- 풍성한 도메인 오브젝트 (Rich Domain Model)
  - 데이터와 해당 데이터 기반 로직을 함께 보유
  - 응집도는 높으나 DI 및 계층 의존 설계에 주의 필요

## 9.3.4 스프링 애플리케이션을 위한 아키텍처 설계
- POJO 중심 설계 + DI + AOP를 기반으로 한 아키텍처가 핵심
- 스프링은 계층형 아키텍처에 적합하도록 설계됨

### 권장 기본 구조
- 프레젠테이션 계층
  - Spring MVC 기반 Controller
- 서비스 계층
  - POJO 비즈니스 로직
  - 트랜잭션 AOP 적용
- 데이터 액세스 계층
  - Repository/DAO
  - ORM 기반 데이터 접근
  - 예외 전환 적용

### 설계 시 주의사항
- 서비스 계층은 특정 기술 API에 직접 의존하지 않도록 설계
- 프레젠테이션 계층 객체(HttpServletRequest 등)를 서비스 계층으로 전달하지 않음
- 계층 간 데이터 전달은 DTO 또는 도메인 오브젝트 사용
- 공통 기능(트랜잭션, 로깅, 보안, 예외 변환 등)은 AOP로 분리
- 규모와 복잡도에 따라 계층 통합 또는 분리 전략을 유연하게 적용
